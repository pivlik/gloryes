{"version":3,"sources":["app.js"],"names":["define","$","$substrate","length","require","app","run","window","location","pathname","$forms","initForms","Form","each","this","init","filter","document","on","e","$popupLink","target","Popup","hash","popup","initPopup","attr","showPopup","$gallerys","Gallery","$gallerysSlick","GallerySlick","initGallery","$animLabels","AnimatedLabel","$selects","selectric","disableOnMobile","$tabContainers","Tabs","$maps","Map","$constructionProgress","ConstructionsProgress","$sliders","RangeSlider","$search","SearchFilter","$searchResult","SearchResult","$mortgage","Mortgage","$table","hasClass","wrap","$favorite","Favorite","$showBtnUp","hasScrolled","curPos","scrollTop","Math","abs","lastScrollTop","delta","height","showPos","addClass","scrollUp","removeClass","didScroll","click","animate","scroll","setInterval","is","parent","$scrollbar","scrollbarCheck","hasScrollbar","innerWidth","documentElement","clientWidth","debounce"],"mappings":"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","file":"../app.js","sourcesContent":["'use strict';\n\ndefine('app', ['jquery'], function ($) {\n    'use strict';\n\n    (function ($substrate) {\n        if (!$substrate.length) {\n            return;\n        }\n\n        $(function () {\n            require(['apartments/app'], function (app) {\n                app.run(window.location.pathname);\n            });\n        });\n    })($('#substrate'));\n\n    (function ($forms) {\n        if (!$forms.length) {\n            return;\n        }\n\n        var initForms = function initForms(Form) {\n            $forms.each(function () {\n                var form = new Form($(this));\n                form.init();\n            });\n        };\n        require(['app/form'], initForms);\n    })($('form').filter(':not([data-noinit])'));\n\n    //Подключение попапа\n    //Так как кнопки с попапом иногда создаются динамически, вешаем на document.click\n    $(document).on('click', '.j-popup', function (e) {\n        var $popupLink = $(e.target);\n\n        if (!$popupLink.length) {\n            return;\n        }\n\n        require(['app/popup'], function (Popup) {\n            var hash = window.location.hash;\n            var popup = new Popup($popupLink);\n            popup.initPopup();\n\n            if ($popupLink.attr('href') === hash) {\n                popup.showPopup($popupLink);\n            }\n        });\n    });\n\n    // Подключение галерей\n    (function ($gallerys) {\n        if (!$gallerys.length) {\n            return;\n        }\n\n        require(['app/gallery'], function (Gallery) {\n            $gallerys.each(function () {\n                return new Gallery($(this));\n            });\n        });\n    })($('.j-gallery'));\n\n    // Подключение галерей со сликом\n    (function ($gallerysSlick) {\n        if (!$gallerysSlick.length) {\n            return;\n        }\n\n        require(['app/gallery-slick'], function (GallerySlick) {\n            $gallerysSlick.each(function () {\n                var gallery = new GallerySlick($(this));\n                gallery.initGallery();\n            });\n        });\n    })($('.j-gallery-slick'));\n\n    //Анимированный label\n    (function ($animLabels) {\n        if (!$animLabels.length) {\n            return;\n        }\n\n        require(['app/animated-label'], function (AnimatedLabel) {\n            $animLabels.each(function () {\n                var label = new AnimatedLabel($(this));\n                label.init();\n            });\n        });\n    })($('.j-anim-label'));\n\n    // Стилизация селекта\n    (function ($selects) {\n        if (!$selects.length) {\n            return;\n        }\n\n        require(['select'], function () {\n            $selects.each(function () {\n                var $select = $(this);\n                $select.selectric({\n                    disableOnMobile: false\n                });\n            });\n        });\n    })($('select'));\n\n    // Табы\n    (function ($tabContainers) {\n        if (!$tabContainers.length) {\n            return;\n        }\n\n        require(['app/tabs'], function (Tabs) {\n            $tabContainers.each(function () {\n                return new Tabs($(this));\n            });\n        });\n    })($('.j-tabs'));\n\n    //Инициализация карты\n    (function ($maps) {\n        if (!$maps.length) {\n            return;\n        }\n\n        require(['app/map'], function (Map) {\n            $maps.each(function () {\n                return new Map($(this));\n            });\n        });\n    })($('.j-map'));\n\n    // Ход строительства\n    (function ($constructionProgress) {\n        if (!$constructionProgress.length) {\n            return;\n        }\n\n        require(['app/construction-progress'], function (ConstructionsProgress) {\n            return new ConstructionsProgress($constructionProgress);\n        });\n    })($('.j-construction-progress'));\n\n    // Range slider\n    (function ($sliders) {\n        if (!$sliders.length) {\n            return;\n        }\n\n        require(['app/range-slider'], function (RangeSlider) {\n            $sliders.each(function () {\n                return new RangeSlider($(this));\n            });\n        });\n    })($('.j-range-sliders'));\n\n    // Страница поиска\n    (function ($search) {\n        if (!$search.length) {\n            return;\n        }\n\n        require(['app/search-filter'], function (SearchFilter) {\n            return new SearchFilter($search);\n        });\n    })($('.j-search-filter'));\n\n    // Результаты поиска\n    (function ($searchResult) {\n        if (!$searchResult.length) {\n            return;\n        }\n\n        require(['app/search-result'], function (SearchResult) {\n            return new SearchResult($searchResult);\n        });\n    })($('.j-search-result'));\n\n    // Ипотека\n    (function ($mortgage) {\n        if (!$mortgage.length) {\n            return;\n        }\n\n        require(['app/mortgage'], function (Mortgage) {\n            return new Mortgage($mortgage);\n        });\n    })($('.j-mortgage'));\n\n    // Таблицы в WYSIWYG\n    (function ($table) {\n        if (!$table.length) {\n            return;\n        }\n\n        if (!$table.hasClass('b-table')) {\n            $table.each(function () {\n                $(this).wrap('<div class=\"b-table__content\"></div>');\n            });\n        }\n    })($('.b-typo-reset table'));\n\n    // Избранное\n    (function ($favorite) {\n        if (!$favorite.length) {\n            return;\n        }\n\n        require(['app/favorite'], function (Favorite) {\n            return new Favorite();\n        });\n    })($('.j-favorite'));\n\n    (function ($showBtnUp) {\n        if (!$showBtnUp.length) {\n            return;\n        }\n\n        var didScroll;\n        var lastScrollTop = 0;\n        var delta = 10; // Когда скролл не считается\n        var showPos = 60; // when btn is show. offset of top window\n        var scrollUp = 'is-nav-up';\n\n        $showBtnUp.click(function () {\n            $('body, html').animate({ scrollTop: 0 }, 'slow');\n        });\n\n        $(window).scroll(function () {\n            // jshint ignore:line\n            didScroll = true;\n        });\n\n        function hasScrolled() {\n            var curPos = $(window).scrollTop();\n            if (Math.abs(lastScrollTop - curPos) <= delta) {\n                return; // Return the absolute value of a number\n            }\n            // если упирается вниз, то появляется кнопка\n            if (curPos + $(window).height() + showPos >= $(document).height()) {\n                $showBtnUp.addClass(scrollUp);\n            } else if (curPos > lastScrollTop || curPos < showPos) {\n                // Скролл вниз\n                $showBtnUp.removeClass(scrollUp);\n            } else {\n                //Скролл вверх\n                if (curPos + $(window).height() < $(document).height()) {\n                    $showBtnUp.addClass(scrollUp);\n                }\n            }\n            lastScrollTop = curPos;\n        }\n\n        // Функция проверки скроллинга каждые 250ms, уменьшает\n        // нагрузку, как если бы при проверки каждого пикселя.\n        setInterval(function () {\n            if (didScroll) {\n                hasScrolled();\n                didScroll = false;\n            }\n        }, 150);\n\n        if ($('body').is(':visible')) {\n            $(this).parent().parent().addClass('is-active').parent().parent().addClass('is-active');\n            return false;\n        }\n    })($('.j-show-up'));\n\n    // Убираем ховер у всех элементов во время скролла\n    require(['app/disable-hover']);\n\n    // Определяем есть ли скролл для фикса сетки\n    (function ($scrollbar) {\n        function scrollbarCheck() {\n            var hasScrollbar = window.innerWidth > document.documentElement.clientWidth;\n            var method = !hasScrollbar ? 'addClass' : 'removeClass';\n\n            $scrollbar[method]('no-scrollbar');\n        }\n\n        scrollbarCheck();\n\n        require(['app/utils'], function () {\n            $(window).on('resize', $.debounce(300, function () {\n                scrollbarCheck();\n            }));\n        });\n    })($('body'));\n\n    return {};\n});"]}