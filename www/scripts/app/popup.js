"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(i,n,e){return n&&t(i.prototype,n),e&&t(i,e),i}}();define("app/popup",["magnific-popup","app/map"],function(t,i){return function(){function t(i){_classCallCheck(this,t),this.$link=i,this.$body=$("body"),this.$closeBtn=$(".b-popup__close"),this.popupOptions(),this.bindEvents(),this.initPopup()}return _createClass(t,[{key:"popupOptions",value:function(){var t=this,i=this.$link.data("type");this.options={type:i||"inline",showCloseBtn:!1,fixedContentPos:!0,mainClass:t.collectMainClass(),removalDelay:t.transitionDelay(),callbacks:{open:function(){t.openPopup(),t.transitionDelay(),"ion-slider"===t.$link.data("slider")&&require(["app/range-slider"],function(t){$(".j-range-sliders").each(function(){var i=$(this);i.removeAttr("data-noinit"),setTimeout(function(){return new t(i)},100)})})},close:function(){t.closePopup()}}}}},{key:"collectMainClass",value:function(){var t=[];return this.$link.data("theme")&&t.push("b-popup_theme_"+this.$link.data("theme")),void 0!==this.$link.data("fullsize")&&t.push("b-popup_full_size"),this.$link.data("toggle-time")&&t.push("b-popup_theme_toggle"),t.join(" ")}},{key:"initPopup",value:function(){this.$link.magnificPopup(this.options)}},{key:"bindEvents",value:function(){this.$closeBtn.on("click",this.hidePopup),$(window).on("popstate",this.hidePopup)}},{key:"transitionDelay",value:function(){if(this.transitionTime=this.$link.data("toggle-time"),this.transitionTime)return $(".mfp-bg, .mfp-wrap").css({"transition-duration":this.transitionTime+"ms"}),this.transitionTime}},{key:"openPopup",value:function(){"image"!==this.$link.data("type")&&"iframe"!==this.$link.data("type")&&window.history.pushState("forward",null,this.$link.attr("href")),this.scrollPosition=$(window).scrollTop()||this.$link.offset().top,this.$body.css({position:"fixed",top:-this.scrollPosition}),this.popupTargetOpen()}},{key:"closePopup",value:function(){var t=$(".b-popup__cnt .b-gallery");history.pushState("",document.title,window.location.pathname),this.$body.css({position:"",top:""}),$(window).scrollTop(this.scrollPosition),this.popupTargetClose(),$(".b-construction-progress__gallery").append(t)}},{key:"hidePopup",value:function(){$.magnificPopup.close()}},{key:"showPopup",value:function(t){t.magnificPopup("open")}},{key:"popupTargetOpen",value:function(){var t=this.$link.data("target");if(void 0!==t&&""!==t){var n=$(t).parent(".b-map__cnt").clone(),e=n.find(t).removeAttr("data-noinit");return $(this.$link.attr("href")).find(".b-popup__cnt").append(n),new i(e)}}},{key:"popupTargetClose",value:function(){$("#popup-map").find(".b-popup__cnt").empty()}}]),t}()});
//# sourceMappingURL=../sourcemaps/app/popup.js.map
