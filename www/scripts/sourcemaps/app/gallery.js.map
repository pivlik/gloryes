{"version":3,"sources":["app/gallery.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_typeof","Symbol","iterator","obj","constructor","prototype","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","define","$","fotorama","tplLabels","Popup","Gallery","$galleryWrap","this","$gallery","find","$prev","$next","isLoop","data","labels","disabled","eventShow","eventReady","initGallery","increase","value","_this","on","e","toggleArrowView","_this2","css","bindArrowClick","arrowView","labelsCreate","centerArrowsVertically","onWindowResize","click","show","size","addClass","prevMethod","activeIndex","nextMethod","$stageHeight","activeFrame","$stageFrame","height","$arrowPos","top","_this3","window","debounce","$container","$thumbWidth","thumbMargin","elements","each","item","text","push","position","parseInt","append","_this4","$zoom","$galleryContainer","parent","html"],"mappings":"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","file":"../../app/gallery.js","sourcesContent":["'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\ndefine('app/gallery', ['jquery', 'fotorama', 'app/tpl/gallery/labels', 'app/popup', 'app/utils'], function ($, fotorama, tplLabels, Popup) {\n    'use strict';\n\n    /**\n     * Галерея\n     * @param {Object} $galleryWrap - jQery object\n     * @constructor\n     */\n\n    var Gallery = function () {\n        function Gallery($galleryWrap) {\n            _classCallCheck(this, Gallery);\n\n            this.$galleryWrap = $galleryWrap;\n            this.$gallery = $galleryWrap.find('.b-gallery__base');\n            this.$prev = $galleryWrap.find('.j-gallery__prev');\n            this.$next = $galleryWrap.find('.j-gallery__next');\n            this.isLoop = this.$gallery.data('loop');\n            this.labels = this.$gallery.data('labels');\n            this.disabled = 'is-disabled';\n\n            this.eventShow();\n            this.eventReady();\n            this.initGallery();\n            this.increase();\n        }\n\n        /**\n         * Инициализация галереи, подключение фоторамы\n         */\n\n\n        _createClass(Gallery, [{\n            key: 'initGallery',\n            value: function initGallery() {\n                this.$gallery.fotorama();\n            }\n        }, {\n            key: 'eventShow',\n\n\n            /**\n             * Кастомное событие фоторамы - show - срабатывает при каждом показе слайда\n             */\n            value: function eventShow() {\n                var _this = this;\n\n                this.$gallery.on('fotorama:show', function (e, fotorama) {\n                    _this.toggleArrowView(fotorama);\n                });\n            }\n        }, {\n            key: 'eventReady',\n\n\n            /**\n             * Кастомное событие фоторамы - ready - срабатывает, когда фоторама\n             * полностью загружена\n             */\n            value: function eventReady() {\n                var _this2 = this;\n\n                this.$galleryWrap.css('opacity', 1);\n\n                this.$gallery.on('fotorama:ready', function (e, fotorama) {\n                    _this2.bindArrowClick(fotorama);\n                    _this2.arrowView(fotorama);\n                    _this2.labelsCreate(fotorama);\n                    _this2.centerArrowsVertically(fotorama);\n\n                    _this2.onWindowResize(fotorama);\n                });\n            }\n        }, {\n            key: 'bindArrowClick',\n\n\n            /**\n             * Обработка клика по стрелкам\n             * @param {Object} fotorama - конструктор фоторамы\n             */\n            value: function bindArrowClick(fotorama) {\n                this.$prev.click(function () {\n                    fotorama.show('<');\n                });\n\n                this.$next.click(function () {\n                    fotorama.show('>');\n                });\n            }\n        }, {\n            key: 'arrowView',\n\n\n            /**\n             * Показ стрелок, только когда есть слайды и их больше одного\n             * @param {Object} fotorama - конструктор фоторомы\n             */\n            value: function arrowView(fotorama) {\n                if (fotorama.size === 1) {\n                    this.$prev.addClass(this.disabled);\n                    this.$next.addClass(this.disabled);\n                }\n            }\n        }, {\n            key: 'toggleArrowView',\n\n\n            /**\n             * Смена вида у стрелок, у первого и последнего слайда\n             * @param {Object} fotorama - конструктор фоторомы\n             */\n            value: function toggleArrowView(fotorama) {\n                var prevMethod = fotorama.activeIndex === 0 ? 'addClass' : 'removeClass';\n\n                var nextMethod = fotorama.size - fotorama.activeIndex === 1 ? 'addClass' : 'removeClass';\n\n                if (!this.isLoop) {\n                    this.$prev[prevMethod](this.disabled);\n                    this.$next[nextMethod](this.disabled);\n                }\n            }\n        }, {\n            key: 'centerArrowsVertically',\n\n\n            /**\n             * Позиционирование стрелок: они должны находиться на середине высоты\n             * картинок\n             * @param {Object} fotorama\n             */\n\n            value: function centerArrowsVertically(fotorama) {\n                var $stageHeight = $(fotorama.activeFrame.$stageFrame[0]).height();\n                var $arrowPos = $stageHeight / 2 - this.$prev.height() / 2;\n\n                this.$prev.css({\n                    top: $arrowPos\n                });\n\n                this.$next.css({\n                    top: $arrowPos\n                });\n            }\n        }, {\n            key: 'onWindowResize',\n\n\n            /**\n             * Событие, происходящее на ресайз окна\n             * @param {Object} fotorama - конструктор фоторомы\n             */\n            value: function onWindowResize(fotorama) {\n                var _this3 = this;\n\n                $(window).on('resize', $.debounce(300, function () {\n                    _this3.centerArrowsVertically(fotorama);\n                }));\n            }\n        }, {\n            key: 'labelsCreate',\n\n\n            /**\n             * Создание лейблов у тумбочек\n             */\n            value: function labelsCreate() {\n                if (this.labels && _typeof(this.labels) === 'object') {\n                    var $container = this.$gallery.find('.fotorama__nav__shaft');\n                    var $thumbWidth = this.$gallery.data('thumbwidth');\n                    var thumbMargin = this.$gallery.data('thumbmargin') || 2;\n                    var data = {\n                        elements: []\n                    };\n\n                    $.each(this.labels, function (item, text) {\n                        data.elements.push({\n                            position: (parseInt($thumbWidth) + thumbMargin) * item,\n                            text: text\n                        });\n                    });\n\n                    $container.append(tplLabels(data));\n                }\n            }\n        }, {\n            key: 'increase',\n            value: function increase() {\n                var _this4 = this;\n\n                this.$zoom = this.$galleryWrap.find('.b-gallery__increase');\n\n                if (!this.$zoom) {\n                    return;\n                }\n\n                this.$galleryContainer = $('.b-construction-progress__gallery');\n\n                var $gallery = this.$zoom.parent(this.$galleryWrap);\n\n                this.$zoom.on('click', function () {\n                    $('.b-popup__cnt').append($gallery);\n                    _this4.$galleryContainer.html('&nbsp;');\n                });\n\n                return new Popup(this.$zoom);\n            }\n        }]);\n\n        return Gallery;\n    }();\n\n    return Gallery;\n});"]}